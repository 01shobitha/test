<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>VideoLAN Quickstart: Step 3 : Install vls and unicast or broadcast to vlc(s)</TITLE>
 <LINK HREF="videolan-quickstart-5.html" REL=next>
 <LINK HREF="videolan-quickstart-3.html" REL=previous>
 <LINK HREF="videolan-quickstart.html#toc4" REL=contents>
</HEAD>
<BODY>
<A HREF="videolan-quickstart-5.html">Next</A>
<A HREF="videolan-quickstart-3.html">Previous</A>
<A HREF="videolan-quickstart.html#toc4">Contents</A>
<HR>
<H2><A NAME="s4">4.</A> <A HREF="videolan-quickstart.html#toc4">Step 3 : Install vls and unicast or broadcast to vlc(s)</A></H2>


<H2><A NAME="ss4.1">4.1</A> <A HREF="videolan-quickstart.html#toc4.1">Install vls</A>
</H2>



<H3>under Windows</H3>


<P><EM>Warning :</EM> The Windows version of vls can only stream MPEG files
stored on a hard drive. It cannot stream DVDs, satellite channels or
real-time MPEG encoded videos.</P>
<P>Download the Zip file for Windows from the 
<A HREF="http://www.videolan.org/vls/download.html">vls download  page</A>.</P>
<P>Unzip the file in a directory.</P>

<H3>under Linux Debian</H3>


<P>This will only work on Woody or Sid versions, because libdvdread2 is not
present in Potato version.</P>
<P>Edit /etc/apt/sources.list and add the following line :
<BLOCKQUOTE><CODE>
<PRE>
deb ftp://ftp.videolan.org/pub/videolan/debian ./
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Then type as root :
<BLOCKQUOTE><CODE>
<PRE>
apt-get update
apt-get install libdvdcss2 libdvdread2 libdvbpsi1 vls vls-dvd
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>If you don't want to stream DVDs, type instead :
<BLOCKQUOTE><CODE>
<PRE>
apt-get update
apt-get install libdvbpsi1 vls
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>under Linux RedHat, Mandrake or SuSE</H3>


<P>Download the RPM package of libdvdcss version 1.2.2 from 
<A HREF="http://www.videolan.org/pub/videolan/libdvdcss/1.2.2/">http://www.videolan.org/pub/videolan/libdvdcss/1.2.2/</A> and install it.</P>
<P>Download the RPM package of libdvbpsi from 
<A HREF="http://www.videolan.org/libdvbpsi/download.html">libdvbpsi download page</A> and install it.</P>
<P>Download the RPM package of libdvdread from 
<A HREF="http://www.dtek.chalmers.se/groups/dvd/redhat.shtml">http://www.dtek.chalmers.se/groups/dvd/redhat.shtml</A> and install it.</P>
<P>Download the RPM packages vls and vls-dvd from the 
<A HREF="http://www.videolan.org/vls/download.html">vls download page</A> and install them.</P>

<H3>under Linux or Unix</H3>


<P>The method below is for any Unix or Linux supported by vls. We are going
to compile and install the librairies and then vls.</P>

<H3>Install the librairies</H3>


<P>Many librairies are needed for particular uses :
<UL>
<LI><CODE>libdvdcss</CODE> if you want to read encrypted DVDs,</LI>
<LI><CODE>libdvbpsi</CODE>,</LI>
<LI><CODE>libdvdread</CODE> if you want to stream DVDs.</LI>
</UL>
</P>
<P>Download the librairies : take the latest version of libdvdcss from
the 
<A HREF="http://www.videolan.org/libdvdcss/download.html">libdvdcss download page</A>, the latest version of libdvbpsi from
the 
<A HREF="http://www.videolan.org/libdvbpsi/download.html">libdvbpsi download page</A>, and the latest version of libdvdread from
<A HREF="http://www.dtek.chalmers.se/groups/dvd/downloads.shtml">http://www.dtek.chalmers.se/groups/dvd/downloads.shtml</A>.</P>
<P>For each librairie, uncompress, configure, compile and install :
<BLOCKQUOTE><CODE>
<PRE>
% tar -xvzf librairie.tar.gz
% cd librairie
% ./configure
% make
% su
 [enter root password]
# make install
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Check that the configuration file <CODE>/etc/ld.so.conf</CODE>
contains the line :
<BLOCKQUOTE><CODE>
<PRE>
/usr/local/lib
</PRE>
</CODE></BLOCKQUOTE>

If it is not present, as root, add the line and then run <CODE>ldconfig</CODE>.</P>

<H3>Install vls</H3>


<P>Download the sources of the latest release : get the
file <CODE>vls-version.tar.gz</CODE> from the 
<A HREF="http://www.videolan.org/vls/download.html">vls download page</A>. Uncompress :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
% tar xvzf vls-version.tar.gz
% cd vls-version
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>To get the list of configuration options, do :
<BLOCKQUOTE><CODE>
<PRE>
% ./configure --help
</PRE>
</CODE></BLOCKQUOTE>

Configure vls. For example :
<UL>
<LI>if you want a basic vls without DVD support, do :
<BLOCKQUOTE><CODE>
<PRE>
% ./configure --disable-dvd
</PRE>
</CODE></BLOCKQUOTE>
</LI>
<LI>if you want a full vls with libdvbpsi and DVD support, do : 
<BLOCKQUOTE><CODE>
<PRE>
% ./configure
</PRE>
</CODE></BLOCKQUOTE>
</LI>
</UL>
</P>
<P>Then, compile and install :
<BLOCKQUOTE><CODE>
<PRE>
 
% make
% su
 [enter root password]
# make install
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>You can also do a <CODE>make uninstall</CODE>, <CODE>make clean</CODE> or
<CODE>make distclean</CODE> as needed.</P>

<H2><A NAME="ss4.2">4.2</A> <A HREF="videolan-quickstart.html#toc4.2">Unicast to a vlc</A>
</H2>


<P>You are going to send the stream to a client with vlc installed. In this
example, you will unicast from vls (IP address 10.0.0.1) to vlc (IP
address 10.0.0.2).</P>

<H3>Important notions before configuring vls</H3>


<P>In the two configuration files of vls (<CODE>vls.cfg</CODE> and
<CODE>input.cfg</CODE>), you have the three important notions of
<EM>channel</EM>, <EM>input</EM> and <EM>program</EM> that you need to
understand :</P>
<P>
<UL>
<LI>a <EM>channel</EM> is a
particular IP stream, whether unicast, broadcast or multicast, accessed
by IP address and port, just like a satellite channel might be accessed
by satellite coordinates and frequency ;</LI>
<LI>an <EM>input</EM> refers to an actual video input device or simply
a configuration file that groups a number of possible video files to
play ;</LI>
<LI>each of these video files are called a <EM>program</EM>.</LI>
</UL>
</P>

<H3>Configure vls.cfg</H3>


<P>The configuration file <CODE>vls.cfg</CODE> is
the main configuration file of vls. It is located in :
<UL>
<LI><CODE>/usr/local/etc/videolan/vls/vls.cfg</CODE> if you compiled vls,</LI>
<LI>the directory where you uncompressed vls if you use the Windows version,</LI>
<LI><CODE>/etc/videolan/vls/vls.cfg</CODE> if you installed with the packages.</LI>
</UL>
</P>
<P>For now, copy then paste the example below and only personalize the
parameters where there is a comment <CODE># ** PERSONALIZE **</CODE> in the
text. Since version 0.3.2, the configuration file is not case sensitive.</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
BEGIN "Vls"
  LogFile       = "vls.log"
END 

BEGIN "Groups"
  monitor       = "help|browse|logout"
  master        = "help|browse|start|resume|suspend|stop|shutdown|logout"
END

BEGIN "Users"
# ** PERSONALIZE ** use the shell command "mkpasswd"
# to change the default passwords and copy-paste the result below
  monitor       = "3BcKWoiQn0vi6:monitor"       # password is 'monitor'
  bozo          = "JKg2TpPerilnw:master"        # password is 'bozo'
END

BEGIN "Telnet"
  LocalPort     = "9999"
END

BEGIN "Inputs"
  local1       = "local"
END

BEGIN "local1"
# ** PERSONALIZE ** put the path to the configuration file input.cfg
  ConfigPath    = "/usr/local/etc/videolan/vls"
END

BEGIN "Channels"
  client1       = "network"
END

BEGIN "client1"
  Type          = "unicast"
# ** PERSONALIZE ** write the IP address of the client machine below
  DstHost       = "10.0.0.2"
  DstPort       = "1234"
END
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Configure input.cfg</H3>


<P>The configuration file <CODE>input.cfg</CODE> is used to configure the local
inputs of vls (hard drive or DVD player). It is located in :</P>
<P>
<UL>
<LI><CODE>/usr/local/etc/videolan/vls/vls.cfg</CODE> if you compiled vls,</LI>
<LI>the directory where you uncompressed vls if you use the Windows version,</LI>
<LI><CODE>/etc/videolan/vls/vls.cfg</CODE> if you installed with the packages.</LI>
</UL>
</P>
<P>In order to stream the file <CODE>/home/user/presentation_short.vob</CODE>
and a DVD, the configuration file <CODE>input.cfg</CODE> should look like
that :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
BEGIN "Input"
  FilesPath     = ""
  ProgramCount  = "2"
END

BEGIN "1"
  Name          = "presentation"
# ** PERSONALIZE ** write your own path below
  FileName      = "/home/user/presentation_short.vob"
  Type          = "Mpeg2-PS"
END

BEGIN "2"
  Name          = "film"
# ** PERSONALIZE ** write the device corresponding to your DVD drive below
  Device        = "/dev/dvd"
  Type          = "dvd"
END
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Run vls</H3>


<P>First, make sure that you have write access to the device corresponding
to your DVD drive. For that, you should be in the <EM>disk</EM> or
<EM>cdrom</EM> group (look at the permissions in <CODE>/dev</CODE>). As
root, do :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
# adduser my_login disk_or_cdrom
</PRE>
</CODE></BLOCKQUOTE>

and then close your user session and open it again.</P>
<P>If you are under Windows 2000 or XP, you need to need to have
administrator rights on the system.</P>
<P>You have to start vls and give it commands via the telnet interface.
<EM>Important :</EM> : it is necessary to start vls from the repository
where the configuration file <CODE>vls.cfg</CODE> is located. You must
restart vls each time you change the configuration file.</P>
<P>As a normal user, do :
<BLOCKQUOTE><CODE>
<PRE>
% cd [Path to the configuration file vls.cfg]
% vls
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>From any other machine, start a telnet session to vls :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
% telnet 10.0.0.1 9999

Videolan Server Administration System

Login : bozo
Password : bozo
bozo@vls>
</PRE>
</CODE></BLOCKQUOTE>

If you personalized the login and password in <CODE>vls.cfg</CODE>,
write the login and password that you defined.</P>
<P>At the prompt, enter the command to start streaming the file
<CODE>presentation_short.vob</CODE> :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
bozo@vls> start presentation client1 local1 --loop
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>If you want to have the list of the commands, type <CODE>help</CODE>. If
you want to know the syntax of the "start" command, type <CODE>help
start</CODE>.</P>
<P>If you want to stop streaming the file and start to stream the DVD, do :
<BLOCKQUOTE><CODE>
<PRE>
 
bozo@vls> stop local1 presentation
bozo@vls> start film client1 local1
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3><A NAME="runvlc"></A> Run vlc on the client</H3>

<P>On the client, run vlc with this command line :
<BLOCKQUOTE><CODE>
<PRE>
% vlc udp:
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>You can also use the interface :
<BLOCKQUOTE><CODE>
<PRE>
% vlc
</PRE>
</CODE></BLOCKQUOTE>

and then click on "Net" and select "UDP".</P>

<H3>Stop and shutdown vls</H3>

<P>In the telnet interface :
<BLOCKQUOTE><CODE>
<PRE>
bozo@vls> stop local1 film
bozo@vls> shutdown
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H3>Stream the DVD from a hard drive</H3>


<P>By default, you cannot copy the DVD on your hard drive because the DVD
disc needs to be authenticated before you can access the data on it.
This is a protection defined in the DVD standard. You have 2 solutions
to authenticate your DVD (you have to do it again every time you open
and close your DVD drive) :</P>
<P>
<UL>
<LI>stream the DVD with vls from your drive (what you did in this step),</LI>
<LI>read the DVD from your drive locally with vlc.</LI>
</UL>
</P>
<P>Once you have done this, you can copy the DVD on the hard drive :
<BLOCKQUOTE><CODE>
<PRE>
# mount -t iso9660 /dev/dvd /dvd
# cp /dvd/video_ts/* /home/user/dvd
# umount /dvd
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Modify the section concerning the DVD in the configuration file
<CODE>input.cfg</CODE> :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
BEGIN "2"
  Name          = "film"
# ** PERSONALIZE ** write the path where you copied the DVD
  Device        = "/home/user/dvd"
  Type          = "dvd"
END
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Restart vls :
<BLOCKQUOTE><CODE>
<PRE>
% cd [Path to the configuration file vls.cfg]
% vls
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>For production, you should run the program in a screen, so that you can
detach-it and reattach-it :
<BLOCKQUOTE><CODE>
<PRE>
% cd [Path to the configuration file vls.cfg]
% screen vls
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>From any other machine, start a telnet session to vls :</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
% telnet 10.0.0.1 9999

Videolan Server Administration System

Login : bozo
Password : bozo
bozo@vls> start film client1 local1
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>The client machine now receives the DVD which is read from
the hard drive. To know how to run vlc on the client machine, please see the
<A HREF="#runvlc">last section</A>.</P>

<H2><A NAME="ss4.3">4.3</A> <A HREF="videolan-quickstart.html#toc4.3">Broadcast to vlc(s)</A>
</H2>


<P>In the configuration file <CODE>vls.cfg</CODE>, change Type = "unicast"
by Type = "brodcast" and replace the IP address of the client by the
Broadcast IP address of the subnet.</P>
<P>Then restart vls.</P>

<HR>
<A HREF="videolan-quickstart-5.html">Next</A>
<A HREF="videolan-quickstart-3.html">Previous</A>
<A HREF="videolan-quickstart.html#toc4">Contents</A>
</BODY>
</HTML>

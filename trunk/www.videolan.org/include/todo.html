<?
   $title = "VideoLAN - TODO list";
   $lang = "en";
   $date = "1 May 2001";
?>

<h1>TODO list</h1>

<?

function difficulty( $difficulty )
{
return($difficulty);
   switch( $difficulty )
   {
      case "Guru": return( '<font color="red"><b>Guru</b></font>' );
      case "Hard": return( '<font color="#dd7777">Hard</font>' );
      case "Easy": return( '<font color="green"><b>Easy</b></font>' );
          default: return( '<font color="#77dd77">'.$difficulty.'</font>' );
   }
}

function urgency( $urgency )
{
return($urgency);
   switch( $urgency )
   {
       case "Critical": return( '<font color="red"><b>Critical</b></font>' );
      case "Important": return( '<font color="#dd7777">Important</font>' );
       case "Wishlist": return( '<font color="green"><b>Wishlist</b></font>' );
               default: return( '<font color="#77dd77">'.$urgency.'</font>' );
   }
}

function status( $status )
{
return($status);
   switch( $status )
   {
      case "Todo":
         return( '<font color="red"><b>Todo</b></font>' );
      default:
         if( substr($status, 0, 4) == "Done" )
         {
            return( '<font color="green">'.$status.'</font>' );
         }
         else
         {
            return $status;
         }
   }
} ?>

<p> This is a todo-list for <? print
ereg_replace("^.*/([^/]+)/*$","\\1",$dir); ?>. You can also view the <a
href="TODO">plain text</a> version.

Difficulty values are <? print difficulty("Easy");?>, <? print
difficulty("Medium");?>, <? print difficulty("Hard");?>, <? print
difficulty("Guru");?>.

Urgency values are <? print urgency("Wishlist");?>, <? print
urgency("Normal");?>, <? print urgency("Important");?>, <? print
urgency("Critical");?>. </p>

<? if( !$filter ) {
      $st_todo = "on"; $st_inprogress = "on"; $st_done = "no";
      $ur_wishlist = "on"; $ur_normal = "on"; $ur_important = "on";
         $ur_critical = "on";
      $di_easy = "on"; $di_medium = "on"; $di_hard = "on"; $di_guru = "on";
   }

   $sel = "";
?>

<form action="todo.html" method="post">
  <table>
    <tr>
      <td>
        Items with status:
      </td><td>
        <input type="checkbox" name="st_todo" <?if($st_todo=="on"){
            ?>checked="checked"<? $sel.="st_todo ";}?> />Todo
        <input type="checkbox" name="st_inprogress" <?if($st_inprogress=="on"){
            ?>checked="checked"<? $sel.="st_inprogress ";}?> />In Progress
        <input type="checkbox" name="st_done" <?if($st_done=="on"){
            ?>checked="checked"<? $sel.="st_done ";}?> />Done
      </td>
    </tr><tr>
      <td>
        Items with urgency:
      </td><td>
        <input type="checkbox" name="ur_wishlist" <?if($ur_wishlist=="on"){
            ?>checked="checked"<? $sel.="ur_wishlist ";}?> />Wishlist
        <input type="checkbox" name="ur_normal" <?if($ur_normal=="on"){
            ?>checked="checked"<? $sel.="ur_normal ";}?> />Normal
        <input type="checkbox" name="ur_important" <?if($ur_important=="on"){
            ?>checked="checked"<? $sel.="ur_important ";}?> />Important
        <input type="checkbox" name="ur_critical" <?if($ur_critical=="on"){
            ?>checked="checked"<? $sel.="ur_critical ";}?> />Critical
      </td>
    </tr><tr>
      <td>
        Items with difficulty:
      </td><td>
        <input type="checkbox" name="di_easy" <?if($di_easy=="on"){
            ?>checked="checked"<? $sel.="di_easy ";} ?> />Easy
        <input type="checkbox" name="di_medium" <?if($di_medium=="on"){
            ?>checked="checked"<? $sel.="di_medium ";}?> />Medium
        <input type="checkbox" name="di_hard" <?if($di_hard=="on"){
            ?>checked="checked"<? $sel.="di_hard ";}?> />Hard
        <input type="checkbox" name="di_guru" <?if($di_guru=="on"){
            ?>checked="checked"<? $sel.="di_guru ";}?> />Guru
      </td>
    </tr><tr>
      <td>

      </td><td>
        <input type="submit" name="filter" value="Filter" />
      </td>
    </tr>
  </table>
</form>

<?
   $file = file("TODO");

   $task = "";

   for( $i=0; $i<count($file); $i++)
   {
      $line = htmlspecialchars(ereg_replace("\n","",$file[$i]));

      if( !ereg("^ *#",$line) )
      {
         if( ereg("^Task:",$line) || (($i+1) == count($file)) )
         {
             $status_replace=eregi_replace("Done.*","done",$status);
             $status_replace=eregi_replace("In Progress.*","inprogress",$status_replace);
             if( $task != ""
                 && eregi("ur_".$urgency,$sel)
                 && eregi("di_".$difficulty,$sel)
                 && eregi("st_".$status_replace,$sel))
             {
                 $status_split=explode(",",$status);
                 if( $status_split[0] == "Todo" )
                 {
                     $title='<b>'.$task.'</b>: <b>'.$description.'</b>';
                     startbox($title,"red"); ?><p>
                     <b>Status</b>: <? print status($status); ?>
                     &nbsp; &nbsp;
                     <b>Urgency</b>: <? print urgency($urgency); ?>
                     &nbsp; &nbsp;
                     <b>Difficulty</b>: <? print difficulty($difficulty); ?>
                     </p><p><b>Description</b>: <? print $text; ?></p><?
                 }
                 else if ( $status_split[0] == "In Progress" )
                 {
                     $title='<b>'.$task.'</b>: <b>'.$description.'</b>';
                     startbox($title,"blue"); ?><p>
                     <b>Status</b>: <? print status($status); ?>
                     &nbsp; &nbsp;
                     <b>Urgency</b>: <? print urgency($urgency); ?>
                     &nbsp; &nbsp;
                     <b>Difficulty</b>: <? print difficulty($difficulty); ?>
                     </p><p><b>Description</b>: <? print $text; ?></p><?
                 }
                 else
                 {
                     $title='<b>'.$task.'</b>: <b>'.$description.'</b>';
                     startbox($title,"green"); ?><p>
                     <b>Status:</b> <? print status($status); ?>
                     &nbsp; &nbsp;
                     <b>Urgency:</b> <? print urgency($urgency); ?>
                     &nbsp; &nbsp;
                     <b>Difficulty:</b> <? print difficulty($difficulty); ?>
                     </p><p><b>Description</b>: <? print $text; ?></p><?
                 }
                 stopbox(); ?><br /><?
             }
             $task = substr($line, 6);
             $text = "";
         }
         else if( substr($line, 0, 11) == "Difficulty:" )
         {
             $difficulty = substr($line, 12);
         }
         else if( substr($line, 0, 12) == "Description:" )
         {
             $description = substr($line, 13);
         }
         else if( substr($line, 0, 8) == "Urgency:" )
         {
             $urgency = substr($line, 9);
         }
         else if( substr($line, 0, 7) == "Status:" )
         {
             $status = substr($line, 8);
             if( $status == "Todo" )
             {
                 $suffix = "todo";
             }
             else
             {
                 $suffix = "done";
             }
             $varname = $suffix.$difficulty;
             $$varname++;
             $varname = $suffix.$urgency;
             $$varname++;
         }
         else $text.= $line;

      }
   }
?>

<? function stats( $quux )
{
    $varname = "done".$quux;
    global $$varname;
    ?><b><? if( $$varname == "" ) { ?>none<? } else echo $$varname; ?></b><?
    ?> done, <?
    $varname = "todo".$quux;
    global $$varname;
    ?><b><? if( $$varname == "" ) { ?>none<? } else echo $$varname; ?></b><?
    ?> remaining<?
} ?>

<table border="0" cellspacing="0" cellpadding="10"><tr>
<td><? print urgency( "Critical" ); ?> items: <? stats( "Critical" ); ?></td>
<td align="right">items with difficulty <? print difficulty( "Guru" ); ?>:
    <? stats( "Guru" ); ?></td>
</tr><tr>
<td><? print urgency( "Important" ); ?> items: <? stats( "Important" ); ?></td>
<td align="right">items with difficulty <? print difficulty( "Hard" ); ?>:
    <? stats( "Hard" ); ?></td>
</tr><tr>
<td><? print urgency( "Normal" ); ?> items: <? stats( "Normal" ); ?></td>
<td align="right">items with difficulty <? print difficulty( "Medium" ); ?>:
    <? stats( "Medium" ); ?></td>
</tr><tr>
<td><? print urgency( "Wishlist" ); ?> items: <? stats( "Wishlist" ); ?></td>
<td align="right">items with difficulty <? print difficulty( "Easy" ); ?>:
    <? stats( "Easy" ); ?></td>
</tr></table>

